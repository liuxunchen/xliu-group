import numpy as np
import matplotlib.pyplot as plt
from scipy import constants
import math as math


hitran = np.array([
 [  0, 2349.917073, 3.488E-19, 1.410E+02, 0.0927, 0.125,    0.0000, 0.78, -0.001734 ,   3.0],#    0 0 0 11       0 0 0 01                    R  0e     6377741827 5 4 5 7     3.0    1.0
 [  2, 2351.447160, 1.035E-18, 1.816E+02, 0.0884, 0.119,    2.3413, 0.78, -0.001844 ,   7.0],#    0 0 0 11       0 0 0 01                    R  2e     6377741827 5 4 5 7     7.0    5.0
 [  4, 2352.952588, 1.680E-18, 1.929E+02, 0.0871, 0.116,    7.8043, 0.76, -0.001749 ,  11.0],#    0 0 0 11       0 0 0 01                    R  4e     6377741827 5 4 5 7    11.0    9.0
 [  6, 2354.433332, 2.256E-18, 1.983E+02, 0.0853, 0.114,   16.3890, 0.74, -0.001813 ,  15.0],#    0 0 0 11       0 0 0 01                    R  6e     5377741827 5 4 5 7    15.0   13.0
 [  8, 2355.889366, 2.740E-18, 2.016E+02, 0.0831, 0.111,   28.0951, 0.71, -0.001975 ,  19.0],#    0 0 0 11       0 0 0 01                    R  8e     5377841827 5 4 5 7    19.0   17.0
 [ 10, 2357.320664, 3.116E-18, 2.037E+02, 0.0809, 0.108,   42.9225, 0.70, -0.002182 ,  23.0],#    0 0 0 11       0 0 0 01                    R 10e     5377741827 5 4 5 7    23.0   21.0
 [ 12, 2358.727205, 3.376E-18, 2.054E+02, 0.0788, 0.106,   60.8709, 0.69, -0.002304 ,  27.0],#    0 0 0 11       0 0 0 01                    R 12e     5377741827 5 4 5 7    27.0   25.0
 [ 14, 2360.108962, 3.516E-18, 2.067E+02, 0.0767, 0.104,   81.9401, 0.69, -0.002420 ,  31.0],#    0 0 0 11       0 0 0 01                    R 14e     5377641827 5 4 5 7    31.0   29.0
 [ 16, 2361.465910, 3.543E-18, 2.077E+02, 0.0748, 0.102,  106.1297, 0.69, -0.002557 ,  35.0],#    0 0 0 11       0 0 0 01                    R 16e     5377641827 5 4 5 7    35.0   33.0
 [ 18, 2362.798027, 3.468E-18, 2.086E+02, 0.0733, 0.100,  133.4393, 0.70, -0.002650 ,  39.0],#    0 0 0 11       0 0 0 01                    R 18e     5377641827 5 4 5 7    39.0   37.0
 [ 20, 2364.105288, 3.306E-18, 2.093E+02, 0.0720, 0.099,  163.8684, 0.71, -0.002714 ,  43.0],#    0 0 0 11       0 0 0 01                    R 20e     5377641827 5 4 5 7    43.0   41.0
 [ 22, 2365.387662, 3.076E-18, 2.100E+02, 0.0710, 0.097,  197.4166, 0.72, -0.002753 ,  47.0],#    0 0 0 11       0 0 0 01                    R 22e     5377641827 5 4 5 7    47.0   45.0
 [ 24, 2366.645133, 2.798E-18, 2.106E+02, 0.0702, 0.095,  234.0834, 0.73, -0.002794 ,  51.0],#    0 0 0 11       0 0 0 01                    R 24e     5377541827 5 4 5 7    51.0   49.0
 [ 26, 2367.877678, 2.490E-18, 2.111E+02, 0.0695, 0.094,  273.8680, 0.74, -0.002846 ,  55.0],#    0 0 0 11       0 0 0 01                    R 26e     5377641827 5 4 5 7    55.0   53.0
 [ 28, 2369.085266, 2.171E-18, 2.116E+02, 0.0691, 0.092,  316.7699, 0.75, -0.002875 ,  59.0],#    0 0 0 11       0 0 0 01                    R 28e     5377641827 5 4 5 7    59.0   57.0
 [ 30, 2370.267879, 1.856E-18, 2.121E+02, 0.0688, 0.090,  362.7883, 0.75, -0.002897 ,  63.0],#    0 0 0 11       0 0 0 01                    R 30e     5377641827 5 4 5 7    63.0   61.0
 [ 32, 2371.425488, 1.556E-18, 2.125E+02, 0.0685, 0.088,  411.9225, 0.76, -0.002900 ,  67.0],#    0 0 0 11       0 0 0 01                    R 32e     5377641827 5 4 5 7    67.0   65.0
 [ 34, 2372.558079, 1.280E-18, 2.128E+02, 0.0683, 0.086,  464.1717, 0.76, -0.002898 ,  71.0],#    0 0 0 11       0 0 0 01                    R 34e     5377641827 5 4 5 7    71.0   69.0
 [ 36, 2373.665624, 1.034E-18, 2.132E+02, 0.0681, 0.084,  519.5350, 0.76, -0.002914 ,  75.0],#    0 0 0 11       0 0 0 01                    R 36e     5377641827 5 4 5 7    75.0   73.0
 [ 38, 2374.748098, 8.200E-19, 2.135E+02, 0.0680, 0.082,  578.0116, 0.76, -0.002927 ,  79.0],#    0 0 0 11       0 0 0 01                    R 38e     5377641827 5 4 5 7    79.0   77.0
 [ 40, 2375.805466, 6.390E-19, 2.138E+02, 0.0678, 0.080,  639.6004, 0.75, -0.002943 ,  83.0],#    0 0 0 11       0 0 0 01                    R 40e     5377641827 5 4 5 7    83.0   81.0
 [ 42, 2376.837736, 4.893E-19, 2.141E+02, 0.0677, 0.079,  704.3005, 0.75, -0.002951 ,  87.0],#    0 0 0 11       0 0 0 01                    R 42e     5377641827 5 4 5 7    87.0   85.0
 [ 44, 2377.844871, 3.682E-19, 2.143E+02, 0.0675, 0.077,  772.1107, 0.75, -0.002960 ,  91.0],#    0 0 0 11       0 0 0 01                    R 44e     5377641827 5 4 5 7    91.0   89.0
 [ 46, 2378.826821, 2.724E-19, 2.146E+02, 0.0673, 0.075,  843.0301, 0.74, -0.002987 ,  95.0],#    0 0 0 11       0 0 0 01                    R 46e     5377641827 5 4 5 7    95.0   93.0
 [ 48, 2379.783607, 1.982E-19, 2.149E+02, 0.0671, 0.074,  917.0573, 0.73, -0.003016 ,  99.0],#    0 0 0 11       0 0 0 01                    R 48e     5377741827 5 4 5 7    99.0   97.0
 [ 50, 2380.715173, 1.417E-19, 2.150E+02, 0.0668, 0.073,  994.1913, 0.73, -0.003046 , 103.0],#    0 0 0 11       0 0 0 01                    R 50e     5377741827 5 4 5 7   103.0  101.0
 [ 52, 2381.621565, 9.971E-20, 2.153E+02, 0.0666, 0.072, 1074.4305, 0.72, -0.003077 , 107.0],#    0 0 0 11       0 0 0 01                    R 52e     5377741827 5 4 5 7   107.0  105.0
 [ 54, 2382.502657, 6.900E-20, 2.155E+02, 0.0663, 0.071, 1157.7740, 0.71, -0.003105 , 111.0],#    0 0 0 11       0 0 0 01                    R 54e     5377741827 5 4 5 7   111.0  109.0
 [ 56, 2383.358444, 4.697E-20, 2.157E+02, 0.0660, 0.070, 1244.2205, 0.71, -0.003148 , 115.0],#    0 0 0 11       0 0 0 01                    R 56e     5377741827 5 4 5 7   115.0  113.0
 [ 58, 2384.189005, 3.145E-20, 2.158E+02, 0.0656, 0.069, 1333.7679, 0.70, -0.003191 , 119.0],#    0 0 0 11       0 0 0 01                    R 58e     5377741827 5 4 5 7   119.0  117.0
 [ 60, 2384.994221, 2.072E-20, 2.160E+02, 0.0653, 0.069, 1426.4153, 0.69, -0.003229 , 123.0],#    0 0 0 11       0 0 0 01                    R 60e     5377741827 5 4 5 7   123.0  121.0
 [ 62, 2385.774135, 1.344E-20, 2.162E+02, 0.0650, 0.068, 1522.1611, 0.69, -0.003277 , 127.0],#    0 0 0 11       0 0 0 01                    R 62e     5377741827 5 4 5 7   127.0  125.0
 [ 64, 2386.528581, 8.572E-21, 2.163E+02, 0.0646, 0.068, 1621.0035, 0.68, -0.003324 , 131.0],#    0 0 0 11       0 0 0 01                    R 64e     5377741827 5 4 5 7   131.0  129.0
 [ 66, 2387.257816, 5.382E-21, 2.164E+02, 0.0642, 0.067, 1722.9413, 0.68, -0.003374 , 135.0],#    0 0 0 11       0 0 0 01                    R 66e     5377641827 5 4 5 7   135.0  133.0
 [ 68, 2387.961542, 3.326E-21, 2.166E+02, 0.0637, 0.067, 1827.9724, 0.67, -0.003432 , 139.0],#    0 0 0 11       0 0 0 01                    R 68e     5377641827 5 4 5 7   139.0  137.0
 [ 70, 2388.639929, 2.023E-21, 2.167E+02, 0.0633, 0.066, 1936.0953, 0.66, -0.003485 , 143.0],#    0 0 0 11       0 0 0 01                    R 70e     5377641827 5 4 5 7   143.0  141.0
 [ 72, 2389.292788, 1.211E-21, 2.168E+02, 0.0629, 0.066, 2047.3081, 0.66, -0.003548 , 147.0],#    0 0 0 11       0 0 0 01                    R 72e     5377641827 5 4 5 7   147.0  145.0
 [ 74, 2389.920233, 7.137E-22, 2.169E+02, 0.0625, 0.065, 2161.6091, 0.66, -0.003610 , 151.0],#    0 0 0 11       0 0 0 01                    R 74e     5377641827 5 4 5 7   151.0  149.0
 [ 76, 2390.522224, 4.140E-22, 2.169E+02, 0.0620, 0.065, 2278.9963, 0.65, -0.003664 , 155.0],#    0 0 0 11       0 0 0 01                    R 76e     4377641827 5 4 5 7   155.0  153.0
 [ 78, 2391.098651, 2.364E-22, 2.170E+02, 0.0616, 0.065, 2399.4680, 0.65, -0.003720 , 159.0],#    0 0 0 11       0 0 0 01                    R 78e     4377641827 5 4 5 7   159.0  157.0
 [ 80, 2391.649608, 1.329E-22, 2.171E+02, 0.0611, 0.064, 2523.0217, 0.65, -0.003768 , 163.0],#    0 0 0 11       0 0 0 01                    R 80e     4377641827 5 4 5 7   163.0  161.0
 [ 82, 2392.175077, 7.358E-23, 2.172E+02, 0.0607, 0.064, 2649.6560, 0.65, -0.003824 , 167.0],#    0 0 0 11       0 0 0 01                    R 82e     4377641827 5 4 5 7   167.0  165.0
 [ 84, 2392.675004, 4.010E-23, 2.172E+02, 0.0603, 0.064, 2779.3687, 0.65, -0.003888 , 171.0],#    0 0 0 11       0 0 0 01                    R 84e     4377641827 5 4 5 7   171.0  169.0
 [ 86, 2393.149224, 2.152E-23, 2.173E+02, 0.0599, 0.064, 2912.1572, 0.65, -0.003946 , 175.0],#    0 0 0 11       0 0 0 01                    R 86e     4377541827 5 4 5 7   175.0  173.0
 [ 88, 2393.597874, 1.137E-23, 2.173E+02, 0.0595, 0.063, 3048.0198, 0.65, -0.004005 , 179.0],#    0 0 0 11       0 0 0 01                    R 88e     4377541827 5 4 5 7   179.0  177.0
 [ 90, 2394.020948, 5.914E-24, 2.173E+02, 0.0590, 0.063, 3186.9541, 0.65, -0.004062 , 183.0],#    0 0 0 11       0 0 0 01                    R 90e     4377541827 5 4 5 7   183.0  181.0
 [ 92, 2394.418060, 3.030E-24, 2.173E+02, 0.0586, 0.063, 3328.9578, 0.65, -0.004122 , 187.0],#    0 0 0 11       0 0 0 01                    R 92e     4377541827 5 4 5 7   187.0  185.0
 [ 94, 2394.790248, 1.528E-24, 2.173E+02, 0.0583, 0.063, 3474.0286, 0.65, -0.004184 , 191.0],#    0 0 0 11       0 0 0 01                    R 94e     4377541827 5 4 5 7   191.0  189.0
 [ 96, 2395.136206, 7.592E-25, 2.173E+02, 0.0579, 0.062, 3622.1641, 0.65, -0.004238 , 195.0],#    0 0 0 11       0 0 0 01                    R 96e     4377541827 5 4 5 7   195.0  193.0
 [ 98, 2395.456616, 3.714E-25, 2.173E+02, 0.0575, 0.062, 3773.3618, 0.65, -0.004285 , 199.0],#    0 0 0 11       0 0 0 01                    R 98e     4377541827 5 4 5 7   199.0  197.0
 [100, 2395.751585, 1.790E-25, 2.174E+02, 0.0571, 0.062, 3927.6194, 0.65, -0.004331 , 203.0],#    0 0 0 11       0 0 0 01                    R100e     3377541827 5 4 5 7   203.0  201.0
 [102, 2396.020721, 8.492E-26, 2.173E+02, 0.0568, 0.062, 4084.9341, 0.66, -0.004384 , 207.0],#    0 0 0 11       0 0 0 01                    R102e     3377541827 5 4 5 7   207.0  205.0
 [104, 2396.263738, 3.968E-26, 2.172E+02, 0.0564, 0.061, 4245.3037, 0.66, -0.004439 , 211.0],#    0 0 0 11       0 0 0 01                    R104e     3377541827 5 4 5 7   211.0  209.0
 [106, 2396.481639, 1.827E-26, 2.173E+02, 0.0561, 0.061, 4408.7251, 0.66, -0.004489 , 215.0],#    0 0 0 11       0 0 0 01                    R106e     3377541827 5 4 5 7   215.0  213.0
 [108, 2396.672735, 8.280E-27, 2.171E+02, 0.0558, 0.061, 4575.1958, 0.66, -0.004540 , 219.0],#    0 0 0 11       0 0 0 01                    R108e     3377541827 5 4 5 7   219.0  217.0
 [110, 2396.839384, 3.697E-27, 2.171E+02, 0.0555, 0.061, 4744.7134, 0.66, -0.004595 , 223.0],#    0 0 0 11       0 0 0 01                    R110e     3377541927 5 4 5 7   223.0  221.0
 [112, 2396.979410, 1.626E-27, 2.170E+02, 0.0551, 0.060, 4917.2744, 0.67, -0.004653 , 227.0],#    0 0 0 11       0 0 0 01                    R112e     3377541827 5 4 5 7   227.0  225.0
 [114, 2397.094125, 7.045E-28, 2.170E+02, 0.0548, 0.060, 5092.8770, 0.67, -0.004710 , 231.0],#    0 0 0 11       0 0 0 01                    R114e     3377541827 5 4 5 7   231.0  229.0
 [116, 2397.182454, 3.006E-28, 2.169E+02, 0.0546, 0.060, 5271.5171, 0.67, -0.004760 , 235.0],#    0 0 0 11       0 0 0 01                    R116e     3377541827 5 4 5 7   235.0  233.0
 [118, 2397.245227, 1.264E-28, 2.169E+02, 0.0543, 0.060, 5453.1924, 0.68, -0.004805 , 239.0],#    0 0 0 11       0 0 0 01                    R118e     3377541927 5 4 5 7   239.0  237.0
 [120, 2397.282072, 5.233E-29, 2.167E+02, 0.0540, 0.060, 5637.9004, 0.68, -0.004847 , 243.0],#    0 0 0 11       0 0 0 01                    R120e     3377541927 5 4 5 7   243.0  241.0
 [122, 2397.293041, 2.135E-29, 2.167E+02, 0.0537, 0.059, 5825.6372, 0.68, -0.004891 , 247.0],#    0 0 0 11       0 0 0 01                    R122e     3377541927 5 4 5 7   247.0  245.0
 [124, 2397.278121, 8.577E-30, 2.165E+02, 0.0535, 0.059, 6016.3999, 0.68, -0.004939 , 251.0],#    0 0 0 11       0 0 0 01                    R124e     3377541927 5 4 5 7   251.0  249.0
 [126, 2397.237297, 3.396E-30, 2.164E+02, 0.0532, 0.059, 6210.1855, 0.69, -0.004986 , 255.0],#    0 0 0 11       0 0 0 01                    R126e     3377541927 5 4 5 7   255.0  253.0
 [128, 2397.170557, 1.324E-30, 2.162E+02, 0.0530, 0.059, 6406.9912, 0.69, -0.005032 , 259.0],#    0 0 0 11       0 0 0 01                    R128e     3377541927 5 4 5 7   259.0  257.0
    ])



I = 0.984204 
c2 = constants.physical_constants['second radiation constant'][0]*100 # CGS cm K
cc = constants.speed_of_light*1E2 # CGS
partition_function = np.loadtxt('q7.txt')[:,1]

T = 296

for i in range(65):
    plt.plot(hitran[i,0],hitran[i,2],'r.')
#    plt.plot(hitran[i,0],hitran[i,3],'r.')
    g = hitran[i,9]
    nu = hitran[i,1]
    A = hitran[i,3]
    E = hitran[i,6]
    S = I * A * g * math.exp(-c2*E/T) * (1-math.exp(-c2*nu/T)) / (8 * math.pi * cc  * partition_function[int(T-1)]* nu**2)
    plt.plot(hitran[i,0],S,'b.')
    plt.plot(hitran[i,0],hitran[i,2]/S,'mo')
#    plt.yscale('log')

# eqn 1

#plt.legend()
plt.show()


