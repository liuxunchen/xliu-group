from sys import path
import voigt_load_par as voigt_par
import voigt_with_database as voigt_database

import numpy as np
import matplotlib.pyplot as plt

# variables
start = 2397.05
end = 2397.39
resolution = 0.001
wavenumber = np.arange(start,end,resolution)
database = '../4.2um_band_database/hitran_fundamental.txt'

hitran = np.array([
 [ 2349.917073, 3.488E-19, 1.410E+02, 0.0927, 0.125,    0.0000, 0.78, -0.001734 ],#  R  0e   3.0    1.0
 [ 2351.447160, 1.035E-18, 1.816E+02, 0.0884, 0.119,    2.3413, 0.78, -0.001844 ],#  R  2e   7.0    5.0
 [ 2352.952588, 1.680E-18, 1.929E+02, 0.0871, 0.116,    7.8043, 0.76, -0.001749 ],#  R  4e  11.0    9.0
 [ 2354.433332, 2.256E-18, 1.983E+02, 0.0853, 0.114,   16.3890, 0.74, -0.001813 ],#  R  6e  15.0   13.0
 [ 2355.889366, 2.740E-18, 2.016E+02, 0.0831, 0.111,   28.0951, 0.71, -0.001975 ],#  R  8e  19.0   17.0
 [ 2357.320664, 3.116E-18, 2.037E+02, 0.0809, 0.108,   42.9225, 0.70, -0.002182 ],#  R 10e  23.0   21.0
 [ 2358.727205, 3.376E-18, 2.054E+02, 0.0788, 0.106,   60.8709, 0.69, -0.002304 ],#  R 12e  27.0   25.0
 [ 2360.108962, 3.516E-18, 2.067E+02, 0.0767, 0.104,   81.9401, 0.69, -0.002420 ],#  R 14e  31.0   29.0
 [ 2361.465910, 3.543E-18, 2.077E+02, 0.0748, 0.102,  106.1297, 0.69, -0.002557 ],#  R 16e  35.0   33.0
 [ 2362.798027, 3.468E-18, 2.086E+02, 0.0733, 0.100,  133.4393, 0.70, -0.002650 ],#  R 18e  39.0   37.0
 [ 2364.105288, 3.306E-18, 2.093E+02, 0.0720, 0.099,  163.8684, 0.71, -0.002714 ],#  R 20e  43.0   41.0
 [ 2365.387662, 3.076E-18, 2.100E+02, 0.0710, 0.097,  197.4166, 0.72, -0.002753 ],#  R 22e  47.0   45.0
 [ 2366.645133, 2.798E-18, 2.106E+02, 0.0702, 0.095,  234.0834, 0.73, -0.002794 ],#  R 24e  51.0   49.0
 [ 2367.877678, 2.490E-18, 2.111E+02, 0.0695, 0.094,  273.8680, 0.74, -0.002846 ],#  R 26e  55.0   53.0
 [ 2369.085266, 2.171E-18, 2.116E+02, 0.0691, 0.092,  316.7699, 0.75, -0.002875 ],#  R 28e  59.0   57.0
 [ 2370.267879, 1.856E-18, 2.121E+02, 0.0688, 0.090,  362.7883, 0.75, -0.002897 ],#  R 30e  63.0   61.0
 [ 2371.425488, 1.556E-18, 2.125E+02, 0.0685, 0.088,  411.9225, 0.76, -0.002900 ],#  R 32e  67.0   65.0
 [ 2372.558079, 1.280E-18, 2.128E+02, 0.0683, 0.086,  464.1717, 0.76, -0.002898 ],#  R 34e  71.0   69.0
 [ 2373.665624, 1.034E-18, 2.132E+02, 0.0681, 0.084,  519.5350, 0.76, -0.002914 ],#  R 36e  75.0   73.0
 [ 2374.748098, 8.200E-19, 2.135E+02, 0.0680, 0.082,  578.0116, 0.76, -0.002927 ],#  R 38e  79.0   77.0
 [ 2375.805466, 6.390E-19, 2.138E+02, 0.0678, 0.080,  639.6004, 0.75, -0.002943 ],#  R 40e  83.0   81.0
 [ 2376.837736, 4.893E-19, 2.141E+02, 0.0677, 0.079,  704.3005, 0.75, -0.002951 ],#  R 42e  87.0   85.0
 [ 2377.844871, 3.682E-19, 2.143E+02, 0.0675, 0.077,  772.1107, 0.75, -0.002960 ],#  R 44e  91.0   89.0
 [ 2378.826821, 2.724E-19, 2.146E+02, 0.0673, 0.075,  843.0301, 0.74, -0.002987 ],#  R 46e  95.0   93.0
 [ 2379.783607, 1.982E-19, 2.149E+02, 0.0671, 0.074,  917.0573, 0.73, -0.003016 ],#  R 48e  99.0   97.0
 [ 2380.715173, 1.417E-19, 2.150E+02, 0.0668, 0.073,  994.1913, 0.73, -0.003046 ],#  R 50e 103.0  101.0
 [ 2381.621565, 9.971E-20, 2.153E+02, 0.0666, 0.072, 1074.4305, 0.72, -0.003077 ],#  R 52e 107.0  105.0
 [ 2382.502657, 6.900E-20, 2.155E+02, 0.0663, 0.071, 1157.7740, 0.71, -0.003105 ],#  R 54e 111.0  109.0
 [ 2383.358444, 4.697E-20, 2.157E+02, 0.0660, 0.070, 1244.2205, 0.71, -0.003148 ],#  R 56e 115.0  113.0
 [ 2384.189005, 3.145E-20, 2.158E+02, 0.0656, 0.069, 1333.7679, 0.70, -0.003191 ],#  R 58e 119.0  117.0
 [ 2384.994221, 2.072E-20, 2.160E+02, 0.0653, 0.069, 1426.4153, 0.69, -0.003229 ],#  R 60e 123.0  121.0
 [ 2385.774135, 1.344E-20, 2.162E+02, 0.0650, 0.068, 1522.1611, 0.69, -0.003277 ],#  R 62e 127.0  125.0
 [ 2386.528581, 8.572E-21, 2.163E+02, 0.0646, 0.068, 1621.0035, 0.68, -0.003324 ],#  R 64e 131.0  129.0
 [ 2387.257816, 5.382E-21, 2.164E+02, 0.0642, 0.067, 1722.9413, 0.68, -0.003374 ],#  R 66e 135.0  133.0
 [ 2387.961542, 3.326E-21, 2.166E+02, 0.0637, 0.067, 1827.9724, 0.67, -0.003432 ],#  R 68e 139.0  137.0
 [ 2388.639929, 2.023E-21, 2.167E+02, 0.0633, 0.066, 1936.0953, 0.66, -0.003485 ],#  R 70e 143.0  141.0
 [ 2389.292788, 1.211E-21, 2.168E+02, 0.0629, 0.066, 2047.3081, 0.66, -0.003548 ],#  R 72e 147.0  145.0
 [ 2389.920233, 7.137E-22, 2.169E+02, 0.0625, 0.065, 2161.6091, 0.66, -0.003610 ],#  R 74e 151.0  149.0
 [ 2390.522224, 4.140E-22, 2.169E+02, 0.0620, 0.065, 2278.9963, 0.65, -0.003664 ],#  R 76e 155.0  153.0
 [ 2391.098651, 2.364E-22, 2.170E+02, 0.0616, 0.065, 2399.4680, 0.65, -0.003720 ],#  R 78e 159.0  157.0
 [ 2391.649608, 1.329E-22, 2.171E+02, 0.0611, 0.064, 2523.0217, 0.65, -0.003768 ],#  R 80e 163.0  161.0
 [ 2392.175077, 7.358E-23, 2.172E+02, 0.0607, 0.064, 2649.6560, 0.65, -0.003824 ],#  R 82e 167.0  165.0
 [ 2392.675004, 4.010E-23, 2.172E+02, 0.0603, 0.064, 2779.3687, 0.65, -0.003888 ],#  R 84e 171.0  169.0
 [ 2393.149224, 2.152E-23, 2.173E+02, 0.0599, 0.064, 2912.1572, 0.65, -0.003946 ],#  R 86e 175.0  173.0
 [ 2393.597874, 1.137E-23, 2.173E+02, 0.0595, 0.063, 3048.0198, 0.65, -0.004005 ],#  R 88e 179.0  177.0
 [ 2394.020948, 5.914E-24, 2.173E+02, 0.0590, 0.063, 3186.9541, 0.65, -0.004062 ],#  R 90e 183.0  181.0
 [ 2394.418060, 3.030E-24, 2.173E+02, 0.0586, 0.063, 3328.9578, 0.65, -0.004122 ],#  R 92e 187.0  185.0
 [ 2394.790248, 1.528E-24, 2.173E+02, 0.0583, 0.063, 3474.0286, 0.65, -0.004184 ],#  R 94e 191.0  189.0
 [ 2395.136206, 7.592E-25, 2.173E+02, 0.0579, 0.062, 3622.1641, 0.65, -0.004238 ],#  R 96e 195.0  193.0
 [ 2395.456616, 3.714E-25, 2.173E+02, 0.0575, 0.062, 3773.3618, 0.65, -0.004285 ],#  R 98e 199.0  197.0
 [ 2395.751585, 1.790E-25, 2.174E+02, 0.0571, 0.062, 3927.6194, 0.65, -0.004331 ],#  R100e 203.0  201.0
 [ 2396.020721, 8.492E-26, 2.173E+02, 0.0568, 0.062, 4084.9341, 0.66, -0.004384 ],#  R102e 207.0  205.0
 [ 2396.263738, 3.968E-26, 2.172E+02, 0.0564, 0.061, 4245.3037, 0.66, -0.004439 ],#  R104e 211.0  209.0
 [ 2396.481639, 1.827E-26, 2.173E+02, 0.0561, 0.061, 4408.7251, 0.66, -0.004489 ],#  R106e 215.0  213.0
 [ 2396.672735, 8.280E-27, 2.171E+02, 0.0558, 0.061, 4575.1958, 0.66, -0.004540 ],#  R108e 219.0  217.0
 [ 2396.839384, 3.697E-27, 2.171E+02, 0.0555, 0.061, 4744.7134, 0.66, -0.004595 ],#  R110e 223.0  221.0
 [ 2396.979410, 1.626E-27, 2.170E+02, 0.0551, 0.060, 4917.2744, 0.67, -0.004653 ],#  R112e 227.0  225.0
 [ 2397.094125, 7.045E-28, 2.170E+02, 0.0548, 0.060, 5092.8770, 0.67, -0.004710 ],#  R114e 231.0  229.0
 [ 2397.182454, 3.006E-28, 2.169E+02, 0.0546, 0.060, 5271.5171, 0.67, -0.004760 ],#  R116e 235.0  233.0
 [ 2397.245227, 1.264E-28, 2.169E+02, 0.0543, 0.060, 5453.1924, 0.68, -0.004805 ],#  R118e 239.0  237.0
 [ 2397.282072, 5.233E-29, 2.167E+02, 0.0540, 0.060, 5637.9004, 0.68, -0.004847 ],#  R120e 243.0  241.0
 [ 2397.293041, 2.135E-29, 2.167E+02, 0.0537, 0.059, 5825.6372, 0.68, -0.004891 ],#  R122e 247.0  245.0
 [ 2397.278121, 8.577E-30, 2.165E+02, 0.0535, 0.059, 6016.3999, 0.68, -0.004939 ],#  R124e 251.0  249.0
 [ 2397.237297, 3.396E-30, 2.164E+02, 0.0532, 0.059, 6210.1855, 0.69, -0.004986 ],#  R126e 255.0  253.0
 [ 2397.170557, 1.324E-30, 2.162E+02, 0.0530, 0.059, 6406.9912, 0.69, -0.005032 ],#  R128e 259.0  257.0
    ])

T6 = [450,500,550,600,650,700,750,800,850,900,950,1000]

# simulation c = 12.5% l = 5 cm
#c = 0.025
#l = 5.0

p = 1
for T in T6[1:]:
    print(T)
    #acoef =  voigt_par.coef(T,p,database,wavenumber)
    bcoef =  voigt_database.coef(T,p,hitran,wavenumber)
#    aod,aab,atr = voigt_par.OD(T,p,c,l,database,wavenumber)
#    bod,bab,btr = voigt_database.OD(T,p,c,l,hitran,wavenumber)
#    plt.plot(wavenumber,aod,'r')
    plt.plot(wavenumber,bcoef,label=str(T))





plt.xlim(start,end)
plt.legend(loc='best')
plt.show()
